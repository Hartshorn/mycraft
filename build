

#####################################################################
#																	# 
#					mycraft build script							#
#																	#
#####################################################################

SOURCE='src/mycraft.c'

OBJECTS='src/error.c src/callbacks.c src/textures.c src/shaders.c'

LIBS='-lGL -lGLEW -lglfw'

OUT='-o bin/mycraft'

CFLAGS='-g -Wall -std=c99 -O0' 

COMPILER='clang'

TEST_SOURCE='test/src/mycraft_test.c'

TEST_OUT='-o test/out/mycraft_test'

TEST_RUN='./test/out/mycraft_test'

#
# cleanup section
# if only cleaning, just exit
#
if [ "$1" == "clean" ]; then
	echo
	echo "	Cleaning up. . . "
	rm -f bin/*
	echo
	echo "	Done Cleaning up."
	echo
	
	if [ "$2" == "only" ]; then
		echo "	Clean Only Exiting. . ."
		echo
		exit 0;
	fi
fi

#
# for the actual test cases, we will likely need the compiled sources
# to exists at the time that we run them, so that will need to happen.
# here we are just running tests with no source (since we arent using
# then yet.
#
if [ "$2" == "test" ] || [ "$1" == "test" ]; then
	echo "	Building Tests . . ."
	$COMPILER $TEST_OUT $TEST_SOURCE
	echo
	echo "	Running Tests . . ."
	echo
	$TEST_RUN
	echo
	echo "	Tests complete."
	echo
	exit 0;
fi

$COMPILER $CFLAGS $LIBS $OUT $OBJECTS $SOURCE

